<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>버티컬 배드민턴 매칭</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700;800;900&family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<!-- HEADER -->
<header class="app-header">
    <div class="header-left">
        <div class="logo">🏸 <h1>버티컬 <span>배드민턴</span></h1></div>
    </div>
    <div class="header-center"><div class="date-display" id="currentDate"></div></div>
    <div class="header-right">
        <button class="btn btn-sheet" id="btnLoadSheet">📥 시트 불러오기</button>
        <button class="btn btn-history" id="btnGameLog">📋 게임 기록</button>
        <button class="btn btn-save" id="btnSaveAttendance">💾 출석 저장</button>
    </div>
</header>

<!-- MAIN -->
<main class="app-main">

    <!-- TOP: 코트 현황 -->
    <section class="section-courts">
        <div class="section-bar">
            <h2>🏟️ 코트 현황</h2>
            <button class="btn btn-ghost-sm" id="btnAddCourt">+ 코트 추가</button>
        </div>
        <div class="courts-row" id="courtsRow"></div>
    </section>

    <!-- BOTTOM -->
    <section class="section-bottom">

        <!-- LEFT: 대기 인원 -->
        <div class="panel panel-players">
            <div class="panel-head">
                <h3>👥 대기 인원 <span class="badge" id="waitingCount">0</span></h3>
                <input type="text" class="search-input" id="searchPlayer" placeholder="🔍 이름 검색">
            </div>
            <div class="filter-row">
                <button class="chip active" data-filter="all">전체</button>
                <button class="chip" data-filter="waiting">대기</button>
                <button class="chip" data-filter="playing">게임중</button>
                <button class="chip" data-filter="resting">휴식</button>
                <button class="chip" data-filter="late">늦참</button>
            </div>
            <div class="player-scroll">
                <div class="player-list" id="playerList"></div>
            </div>
            <div class="panel-foot">
                <button class="btn btn-outline-full" id="btnAddManual">+ 직접 추가</button>
            </div>
        </div>

        <!-- RIGHT: 매칭 -->
        <div class="panel panel-match">
            <div class="panel-head">
                <h3>⚡ 게임 매칭</h3>
            </div>
            <div class="match-bar">
                <div class="type-tabs">
                    <button class="type-tab active" data-type="auto">자동</button>
                    <button class="type-tab" data-type="doubles_m">남복</button>
                    <button class="type-tab" data-type="doubles_f">여복</button>
                    <button class="type-tab" data-type="mixed">혼복</button>
                    <button class="type-tab" data-type="manual">수동</button>
                </div>
                <button class="btn btn-primary-sm" id="btnAutoMatch">⚡ 자동 매칭</button>
            </div>
            <div class="rules-note">
                <strong>매칭 규칙:</strong> 남복/여복 우선 · 비슷한 급수끼리 우선 · 급수 밸런스 · 3게임 이상 쉬지 않도록 · 늦참/휴식 제외
            </div>
            <div class="preview-area" id="previewArea">
                <div class="preview-empty"><p>대기 인원에서 4명 선택 또는<br>자동 매칭을 사용하세요</p></div>
            </div>
            <div class="queue-area">
                <div class="queue-head"><span>📋 대기 게임</span><span class="badge" id="queueCount">0</span></div>
                <div class="queue-scroll" id="queueList">
                    <div class="queue-empty">예정된 게임이 없습니다</div>
                </div>
            </div>
        </div>
    </section>
</main>

<!-- MODAL: 시트 불러오기 -->
<div class="modal-bg" id="modalSheet">
    <div class="modal">
        <div class="modal-top"><h3>📊 구글 시트에서 불러오기</h3><button class="btn-x" onclick="closeModal('modalSheet')">&times;</button></div>
        <div class="modal-mid">
            <p class="modal-desc">오늘 참석할 인원을 선택하세요.</p>
            <div class="sheet-list" id="sheetList"><div class="loader"><div class="spin"></div><span>불러오는 중...</span></div></div>
        </div>
        <div class="modal-bot">
            <button class="btn btn-ghost-sm" id="btnSelectAll">전체 선택</button>
            <button class="btn btn-ghost-sm" id="btnDeselectAll">전체 해제</button>
            <div style="flex:1"></div>
            <button class="btn btn-primary-sm" id="btnConfirmImport">선택 추가</button>
        </div>
    </div>
</div>

<!-- MODAL: 직접 추가 -->
<div class="modal-bg" id="modalAdd">
    <div class="modal modal-sm">
        <div class="modal-top"><h3>선수 직접 추가</h3><button class="btn-x" onclick="closeModal('modalAdd')">&times;</button></div>
        <div class="modal-mid">
            <div class="field"><label>이름</label><input type="text" id="inpName" placeholder="이름"></div>
            <div class="field-row">
                <div class="field"><label>급수</label><select id="inpLevel"><option value="A">A</option><option value="B">B</option><option value="C" selected>C</option><option value="D">D</option><option value="E">E</option></select></div>
                <div class="field"><label>성별</label><select id="inpGender"><option value="남">남</option><option value="여">여</option></select></div>
            </div>
        </div>
        <div class="modal-bot">
            <button class="btn btn-ghost-sm" onclick="closeModal('modalAdd')">취소</button>
            <button class="btn btn-primary-sm" id="btnConfirmAdd">추가</button>
        </div>
    </div>
</div>

<!-- MODAL: 출석 저장 -->
<div class="modal-bg" id="modalSave">
    <div class="modal modal-sm">
        <div class="modal-top"><h3>출석 저장</h3><button class="btn-x" onclick="closeModal('modalSave')">&times;</button></div>
        <div class="modal-mid">
            <p class="modal-desc" id="saveDesc"></p>
            <div class="att-chips" id="attChips"></div>
        </div>
        <div class="modal-bot">
            <button class="btn btn-ghost-sm" onclick="closeModal('modalSave')">취소</button>
            <button class="btn btn-save-sm" id="btnConfirmSave">저장하기</button>
        </div>
    </div>
</div>

<!-- MODAL: 게임 기록 -->
<div class="modal-bg" id="modalGameLog">
    <div class="modal modal-lg">
        <div class="modal-top">
            <h3>📋 금일 게임 기록</h3>
            <div style="display:flex;gap:6px;align-items:center">
                <button class="btn btn-primary-sm" id="btnExportGames">📤 시트에 내보내기</button>
                <button class="btn btn-primary-sm" id="btnExportAttendance">📤 출석 내보내기</button>
                <button class="btn-x" onclick="closeModal('modalGameLog')">&times;</button>
            </div>
        </div>
        <div class="modal-mid">
            <div class="log-summary" id="logSummary"></div>
            <div class="log-list" id="logList">
                <div style="text-align:center;padding:20px;color:var(--txt3)">아직 완료된 게임이 없습니다</div>
            </div>
        </div>
    </div>
</div>

<!-- STATUS DROPDOWN (공유, JS에서 위치 조정) -->
<div class="status-dropdown" id="statusDropdown">
    <button class="sd-item" data-status="waiting">✅ 대기</button>
    <button class="sd-item" data-status="resting">😴 휴식</button>
    <button class="sd-item" data-status="late">🕐 늦참</button>
</div>

<div class="toast-box" id="toastBox"></div>
<script src="app.js"></script>
</body>
</html>
